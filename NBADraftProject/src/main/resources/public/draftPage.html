<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/html">
<head>
	<title>League Draft</title>
	<meta charset="utf-8">
	<link rel="stylesheet" href="draft.css">
</head>
<body onload="javascript:draftQuery(); javascript:document.getElementById('draftTable').classList.toggle('hide2'); javascript:connect()">


<h1>Players</h1>


<table id="draftTable" display="hide">
	<CAPTION ALIGN="top">Choose a NBA Player to Draft</CAPTION>
	<thead>
	<tr>
		<th>  </th><th>Name</th><th>Position</th><th>Team</th><th>Player Rank: Overall</th><th>Player Rank: Position</th><th>Salary</th>
	</tr>
	</thead>
	<tbody>

	</tbody>
</table>





<!--  new search bar for room number search  -->


<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
<script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.4.0.min.js"></script>
<script src="/draft.js"></script>


<script>
		function draftQuery(){
		var obj = {};
		obj.leagueID = sessionStorage.getItem("leagueID");
			$.ajax({
				type: 'GET',						//get data from server to the client
				url: 'http://ec2-54-215-176-11.us-west-1.compute.amazonaws.com/createDraft?leagueID='+obj.leagueID,	//want to get info from here, it's in a JSONObject
			})
			.done(function(data) {
			document.getElementById("draftTable").style.display="block";
			var tbody = $('#draftTable tbody'),
			  props = ["name", "position", "teamCode", "playerRankOverall", "playerRankPos", "salary", "playerID"];
			$.each(data, function(i, data) {
			  var tr = $('<tr id="'+data["playerRankOverall"]+'"><td class="nr">' + '<button type="button" id="'+data["playerID"]+'" class="use-address" onclick="Click(this.id)">Draft</button>' + '</td></tr>');
			  $.each(props, function(i, prop) {
			    $('<td>').html(data[prop]).appendTo(tr);
			  });
			  tbody.append(tr);
			});
			})
			.fail(function(data) {
	            alert("Failed to load data.");
	        });
		}
	</script>
	
	
	
<script>
		function Click(buttonID){
			var obj = {};
			obj.userID=sessionStorage.getItem("userID");
			obj.leagueID=sessionStorage.getItem("leagueID");
			obj.playerID=buttonID;

			$.ajax({
				type: 'POST',						//get data from server to the client
				url: 'http://ec2-54-215-176-11.us-west-1.compute.amazonaws.com/draft',	//want to get info from here, it's in a JSONObject
				data: JSON.stringify(obj),
				contentType: "application/json",
				crossDomain: true
			})
		.done(function(data) {
				alert("You drafted: "+ data.name);
				sendDraft(data.playerRankOverall);
			})
			.fail(function(data) {
	        	alert("Failed to load data.");
	    	});
		}
		
</script>


</body>
</html>

